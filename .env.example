# ==========================================
# Application Configuration
# ==========================================
NODE_ENV=development
PORT=3000

# ==========================================
# Database Configuration (阿里云 RDS)
# ==========================================
# PostgreSQL 连接字符串
# 格式：postgresql://用户名:密码@主机:端口/数据库名?schema=public
DATABASE_URL="postgresql://username:password@localhost:5432/elife_db?schema=public"

# ==========================================
# Redis Configuration (阿里云 Tair 标准版)
# ==========================================
# ⚠️ 重要：必须使用 Tair 标准版（主备架构），不要使用 Tair Serverless KV
#
# Tair Serverless KV 不支持 BullMQ 队列库（缺少 maxmemory-policy: noeviction）
# 必须使用：Tair 标准版（主备架构）或 Tair 企业版
#
# 推荐配置：
#   - 产品：Redis 开源版
#   - 系列：倚天版（最经济）或标准版
#   - 版本：Redis 7.0
#   - 架构：标准版（主备架构，不启用集群）
#   - 规格：1GB 起步
#
# Tair 标准版连接地址示例：
#   - 开发环境：localhost
#   - 生产环境：r-xxxxx.redis.rds.aliyuncs.com
#
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=  # ⚠️ 生产环境必须设置强密码（≥16字符）
REDIS_DB=0

# ==========================================
# Rate Limiting (限流配置)
# ==========================================
# TTL：时间窗口（秒）
THROTTLE_TTL=60
# LIMIT：在时间窗口内允许的最大请求数
THROTTLE_LIMIT=10

# ==========================================
# Unitel API Configuration (Unitel 运营商 API)
# ==========================================
UNITEL_USERNAME=your_username
UNITEL_PASSWORD=your_password
UNITEL_BASE_URL=https://api.unitel.mn/api/v1

# ==========================================
# WeChat Official Account (微信公众号)
# ==========================================
WECHAT_APPID=your_wechat_appid
WECHAT_SECRET=your_wechat_secret

# ==========================================
# WeChat Pay JSAPI (微信支付)
# ==========================================
WECHAT_PAY_MCHID=1234567890
# 商户证书序列号（可从商户平台证书管理页面获取）
WECHAT_PAY_SERIAL_NO=your_cert_serial_no
# 商户私钥（apiclient_key.pem的Base64编码，用于签名API请求）
# 生成方法：cat apiclient_key.pem | base64 | tr -d '\n'
WECHAT_PAY_PRIVATE_KEY=your_base64_encoded_private_key
# APIv3密钥（32字节字符串，可在商户平台设置）
WECHAT_PAY_APIV3_KEY=your_32_character_apiv3_key_here
# 微信支付平台证书公钥（platform_cert.pem的Base64编码，用于验证回调签名）
# 生成方法：cat platform_cert.pem | base64 | tr -d '\n'
# 注意：平台证书需要通过微信支付API下载或在商户平台获取
WECHAT_PAY_PLATFORM_CERT=your_base64_encoded_platform_cert
# 微信支付回调地址
WECHAT_PAY_NOTIFY_URL=https://your-domain.com/api/payment/wechat/notify
WECHAT_PAY_REFUND_NOTIFY_URL=https://your-domain.com/api/payment/wechat/refund-notify

# ==========================================
# JWT Authentication (JWT 认证)
# ==========================================
# 密钥长度必须至少 32 个字符
JWT_SECRET=your-super-secret-key-change-in-production-min-32-characters
# Token 有效期（例如：7d = 7天，24h = 24小时）
JWT_EXPIRES_IN=7d

# ==========================================
# Logging Configuration (日志配置)
# ==========================================
# 日志级别: fatal | error | warn | info | debug | trace
# 推荐生产环境使用 warn，开发环境使用 debug
LOG_LEVEL=warn
# 是否美化日志输出（开发环境 true，生产环境 false）
# 生产环境输出 JSON 格式，SAE 会自动采集到阿里云 SLS
LOG_PRETTY=false

# ==========================================
# 部署说明
# ==========================================
# 1. 阿里云 SAE 部署：
#    - 应用会自动将 stdout 日志推送到 SLS（无需额外配置）
#    - 确保 LOG_PRETTY=false 以输出 JSON 格式日志
#
# 2. 阿里云 Tair 兼容性：
#    - Tair 完全兼容 Redis 协议
#    - 支持 ioredis 客户端和 BullMQ 队列
#    - 推荐使用标准版（主从架构），避免集群版的多 key 限制
#
# 3. 数据库迁移：
#    - 开发环境：npm run prisma:migrate:dev
#    - 生产环境：npm run prisma:migrate:deploy
